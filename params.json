{"name":"Rafflerazzle","tagline":"Twilio raffle manager","body":"# rafflerazzle\r\n\r\n## WORK IN PROGRESS! :)\r\n\r\nPlease leave your comments and suggestions. Feedback and pull requests are very welcome.\r\n\r\nThis is a raffle manager.\r\n\r\nLet's say you run a local meetup, and every meetup you raffle a prize to your participants.This app is supposed to help you keep track of you raffles and participants, using Twilio to handle the communication.\r\n\r\n### How it works\r\n\r\nThe raffle home is in `/`. From there, participants find the number they have to text to enter the raffle.\r\n\r\nThe background image used on the raffle home is `/static/images/cover.png`. The one in the repo is from [WOCin Tech Chat](https://www.flickr.com/photos/wocintechchat) and it is free to use.\r\n\r\nThe Admin page is `/admin`.\r\n\r\n### Some rules\r\n\r\n* You can't delete a winner\r\n* You can't delete a closed raffle\r\n* You can't have 2 raffles at the same time.\r\n* After a raffle is closed it will wait for you to draw a winner. You can do it from Admin home, Admin Raffles, or Raffle page.\r\n\r\n### Improvements to come soon\r\n\r\n* Download participants list in CSV\r\n* Automaticly contact winner via text message\r\n* Make it possible to automaticly draw winner when the raffle ends, if the Admin wants to.\r\n\r\n## Running locally\r\n\r\nFor this app, you will need Mailgun and Twilio.\r\n\r\n- Sign up for Mailgun free account at https://mailgun.com. Youâ€™ll need a few pieces of information from the Mailgun control panel before moving forward:\r\n\r\n1. API Key\r\n2. Sandbox Domain URL (should look like \"sandboxc6235728hdkjehf283hajf13a90679.mailgun.org\"\r\nBoth of these pieces of information can be found on the landing page of the Mailgun control panel.\r\n\r\n- Sign up for [Twilio](https://www.twilio.com/try-twilio). Go to your [account page](https://www.twilio.com/user/account/phone-numbers/incoming) and get the phone number listed there.\r\n\r\nNow that you have everything you need, we will keep your precious keys and number as environment variables. \r\n\r\nYour SECRET_KEY is not from any external service. It is like a password. Use any password you want.\r\n\r\n- On Terminal:\r\n\r\n```\r\n$ export SECRET_KEY=\"YOUR_SECRETKEY\"\r\n$ export MAILGUN_SANDBOX_DOMAIN_URL=\"YOUR_SANDBOX_URL\"\r\n$ export MAILGUN_API_KEY=\"YOUR_API_KEY\"\r\n$ export SECRET_KEY=\"YOUR_SECRET_KEY\"\r\n$ export TWILIO_NUMBER=\"+55555555555\"\r\n```\r\nNote that the \"export\" is limited to the Terminal window you have open. You have to re-export every time you open a new window. (If this gets frustrating, see if you can figure out [autoenv.](https://github.com/kennethreitz/autoenv))\r\n\r\n- Install Postgres:\r\nMac - http://postgresapp.com/\r\nWindows - http://www.postgresql.org/download/windows/\r\nUbuntu - 'apt-get install postgresql'.\r\n\r\n- On Terminal, start psql typing:\r\n\r\n```\r\n$ psql\r\n```\r\n- Now create the database:\r\n```\r\ncreate database raffle;\r\n```\r\n- To exit postgres just type:\r\n```\r\n\\q\r\n```\r\n\r\n- Run the following code to install required dependencies:\r\n\r\n```$ sudo pip install -r requirements.txt```\r\n\r\n`models.py` creates the tables in the database. Before you run it, comment this 2 lines on `app.py`:\r\n\r\n```\r\nfrom views import *\r\ndel session\r\n```\r\n\r\n- Run `models.py` on Terminal, to create the tables in the database:\r\n\r\n```$ python models.py```\r\n\r\nIt will ask you for your email to create the first Admin user. Copy the *temporary password* given. You will need that to login and have access to `/admin`\r\n\r\n- Uncomment those 2 lines before you move forward.\r\n\r\n- Run `app.py` and go to http://127.0.0.1/login to change your password.\r\n\r\nYou're good to go.\r\n\r\nIn case you want to populate the database with some data to make testing easier,\r\n you can run `populate.py`.\r\n\r\n ```$ python populate.py```\r\n\r\n It will create an active, a closed, and an upcoming raffle. All of them with 50 bogus participants.\r\n\r\n* IMPORTANT:* To send and receive text messages, the app needs to be on server exposed to the public Internet, so Twilio can find it. Please find below instructions to do it using Heroku.\r\n\r\n## Deploying it to Heroku \r\n\r\n- First, create a Heroku account: https://signup.heroku.com/\r\n\r\n- Install the Heroku Toolbelt: https://toolbelt.heroku.com/\r\n\r\n- Login to Heroku on Terminal:\r\n\r\n```\r\n$ heroku login\r\nEnter your Heroku credentials.\r\nEmail: your@email.com\r\nPassword:\r\nAuthentication successful.\r\n```\r\n\r\n- Create the app, along with a git remote that must be used to receive your application source:\r\n\r\n```$ heroku apps:create your_app_name```\r\n\r\nBasically what happens here is that now you have one more remote git repo. If you list ou remote repos, you will see your Github and your Heroku repos:\r\n\r\n```$ git remote -v```\r\n\r\n- Again, let's keep your keys and number as environment variables, this time at Heroku:\r\n\r\n```\r\n$ heroku config:set MAILGUN_SANDBOX_DOMAIN_URL=\"YOUR_SANDBOX_URL\"\r\n$ heroku config:set MAILGUN_API_KEY=\"YOUR_API_KEY\"\r\n$ heroku config:set TWILIO_NUMBER=\"+55555555555\"\r\n$ heroku config:add SECRET_KEY=\"YOUR_SECRET_KEY\"\r\n$ heroku config:add TWILIO_NUMBER=\"YOUR_TWILIO_NUMBER\"\r\n```\r\n\r\n- Now let's set your [timezone](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones):\r\n\r\n```$ heroku config:add TZ=\"YOUR_TIME_ZONE\"```\r\n\r\nThis is important because the raffles are time based. If you don't set it right, they won't work as expected.\r\n\r\nNow, enable the PostgreSQL addon. This level is free but does have size and speed limitations (more details). https://elements.heroku.com/addons/heroku-postgresql\r\n\r\n```$ heroku addons:create heroku-postgresql:hobby-dev```\r\n\r\nWhen you've done this you should notice that it sets a variable on Heroku called DATABASE_URL. Check with heroku config. \r\n\r\n```$ heroku config```\r\n\r\nThis variable is in `app.py`:\r\n\r\n```\r\napp.config['SQLALCHEMY_DATABASE_URI'] = os.environ.get('DATABASE_URL', 'postgresql://localhost/raffle')\r\ndb = SQLAlchemy(app)\r\n```\r\n\r\nIt means that when you run `app.py` locally, it will look for DATABASE_URL, fail, then look for the database on localhost.\r\n\r\nBefore you run `models.py` to create the tables in the database, don't forget to comment this 2 lines on `app.py`:\r\n\r\n```\r\nfrom views import *\r\ndel session\r\n```\r\n\r\n- Stage, commit and then push to Heroku:\r\n\r\n```\r\n$ git push heroku\r\n```\r\n\r\nNow every time you push something to Github with `git push`, you will have to push again to Heroku with `git push heroku` if you want it deployed. You can setup a [Github/Heroku integration](https://devcenter.heroku.com/articles/github-integration) if you want to automate this process.\r\n\r\n- Run `models.py` to create the tables in the database:\r\n\r\n```$ heroku run python models.py```\r\n\r\nSame thing: It will ask you for your email to create the first Admin user. Copy the *temporary password* given. You will need that to login and have access to `/admin`.\r\n\r\n- Uncomment those 2 lines in `app.py` before you move forward.\r\n\r\n```\r\nfrom views import *\r\ndel session\r\n```\r\n\r\n- Stage, commit and then push to Heroku:\r\n\r\n```$ git push heroku```\r\n\r\nThe response will look like this:\r\n\r\n```\r\nCounting objects: 4, done.\r\nDelta compression using up to 4 threads.\r\nCompressing objects: 100% (4/4), done.\r\nWriting objects: 100% (4/4), 373 bytes | 0 bytes/s, done.\r\nTotal 4 (delta 3), reused 0 (delta 0)\r\nremote: Compressing source files... done.\r\nremote: Building source:\r\nremote:\r\nremote: -----> Using set buildpack heroku/python\r\nremote: -----> Python app detected\r\nremote: -----> Installing dependencies with pip\r\nremote:\r\nremote:\r\nremote: -----> Discovering process types\r\nremote:        Procfile declares types -> web\r\nremote:\r\nremote: -----> Compressing... done, 41.4MB\r\nremote: -----> Launching... done, v18\r\nremote:        https://your_app_name.herokuapp.com/ deployed to Heroku\r\nremote:\r\nremote: Verifying deploy... done.\r\n```\r\n\r\nGo to https://your_app_name.herokuapp.com/login and you should be able to login.\r\n\r\nIf you want to populate the database: \r\n\r\n```$ heroku run python populate.py```\r\n\r\nHappy raffles!\r\n\r\n\r\nSpecial thanks to Jennie Lees. Good chuncks of this documentation have been written based on her tutorials. Visit her portfolio: http://jennielees.github.io.\r\n\r\n\r\n","google":"UA-71837581-2","note":"Don't delete this file! It's used internally to help with page regeneration."}